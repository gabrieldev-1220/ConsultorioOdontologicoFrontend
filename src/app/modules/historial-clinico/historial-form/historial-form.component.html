<div class="form-container">
  <h2>Nuevo Historial Clínico</h2>

  <form (ngSubmit)="guardar()">
    <!-- MOTIVO -->
    <div class="form-group">
      <label>Motivo de consulta</label>
      <input type="text" [(ngModel)]="historial.motivoConsulta" name="motivo" required />
    </div>

    <!-- ANTECEDENTES -->
    <div class="section">
      <h3>Antecedentes (autocompletado)</h3>
      <p><strong>Alergias:</strong> {{ infoMedica?.alergias || 'Ninguna' }}</p>
      <p><strong>Medicaciones:</strong> {{ infoMedica?.medicacionesActuales || 'Ninguna' }}</p>
    </div>

    <!-- EXÁMENES -->
    <div class="form-group">
      <label>Diagnóstico</label>
      <textarea [(ngModel)]="historial.diagnostico" name="diagnostico" rows="3"></textarea>
    </div>

    <div class="form-group">
      <label>Plan de tratamiento</label>
      <textarea [(ngModel)]="historial.planTratamiento" name="plan" rows="4"></textarea>
    </div>

    <div class="form-group">
      <label>Observaciones</label>
      <textarea [(ngModel)]="historial.observacion" name="obs" rows="2"></textarea>
    </div>

    <!-- ARCHIVOS -->
    <div class="form-group">
      <label>Adjuntar archivos (imágenes, PDF, RX)</label>
      <input type="file" multiple (change)="onFileSelected($event)" />
      <div *ngFor="let file of archivos" class="file-item">
        {{ file.name }}
      </div>
    </div>

    <!-- PROFESIONAL -->
    <div class="profesional">
      <p><strong>Odontólogo:</strong> Dr. {{ getOdontologoNombre() }}</p>
      <p><strong>Matrícula:</strong> {{ getMatricula() }}</p>
    </div>

    <!-- BOTONES -->
    <div class="actions">
      <button type="button" (click)="cancelar()" class="btn-cancel">Cancelar</button>
      <button type="submit" class="btn-save">Guardar</button>
      <button type="button" (click)="guardar(true)" class="btn-cita">Guardar y crear cita</button>
    </div>
  </form>
</div>